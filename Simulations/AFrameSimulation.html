<!DOCTYPE html> 
<html>
	<head>
	<link rel="stylesheet" href="../CSS/LightwebThemes.css">

	<style>

	</style>
	</head>
	<body>
  <h2>A-Frame Simulation</h2>
  <div id="container">
    <iframe id="output"></iframe>

    <div id="editor">
	<button onclick="runCode()">Run Code</button>
      <textarea id="codeInput" spellcheck="false"  placeholder="Type your A-Frame code here..."></textarea>
	  <button onclick="exit()">Exit</button>
    </div>
  </div>

  <script>
const textarea = document.getElementById("codeInput");
	textarea.value 
	= `<html>\n\n\t<head>\n\n\t\t<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@bd6bf821eda2522f84a1dc2b6d78674dfcd06e4a/dist/aframe-master.min.js"><\/script>\n\n\t</head>\n\n\t<body>\n\n\t\t<a-scene>\n\t\t<a-sky color="white"></a-sky>\n\n\t\t<a-box \n\t\t\tposition="0 1.5 -5" \n\t\t\tcolor="tomato" \n\t\t\tanimation="\n\t\t\t\tproperty: rotation;\n\t\t\t\tfrom: 0 0 0;\n\t\t\t\tto: 0 360 0;\n\t\t\t\tloop: true;\n\t\t\t\tdur: 2000;\n\t\t\t\teasing: linear;\n\t\t\t"\n\n\t\t></a-box>\n\n\t\t</a-scene>\n\n\t</body>\n\n</html>`;

  textarea.addEventListener("keydown", (event) => {
    if (event.key === '>') {
        const cursor = textarea.selectionStart;
        const value = textarea.value;

        const before = value.slice(0, cursor);
        const after = value.slice(cursor);

        const tagMatch = before.match(/<(\w+)>$/);

        if (tagMatch) {
          const tagName = tagMatch[1];
          const voidTags = ['br', 'hr', 'img', 'meta', 'input', 'link'];

          if (!voidTags.includes(tagName.toLowerCase())) {
            const closingTag = `</${tagName}>`;

            if (!after.startsWith(closingTag)) {
              textarea.value = before + closingTag + after;

              const newCursor = before.length;
              textarea.setSelectionRange(newCursor, newCursor);
            }
          }
        }
    }
  });
    function runCode() {
	  
      const userCode = document.getElementById("codeInput").value;
      const outputFrame = document.getElementById("output");
      const outputDoc = outputFrame.contentDocument || outputFrame.contentWindow.document;
	  	  
      outputDoc.open();
      outputDoc.write(userCode);
      outputDoc.close();
    }
	
	function exit(){
	document.location = "../MainPages/Simulations.html"
	}
  </script>
		<script src="../Important/DigitalClock.js"></script>
</body>
</html>
		



